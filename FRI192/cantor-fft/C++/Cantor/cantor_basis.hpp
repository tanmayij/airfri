#ifndef CANTOR_BASIS_HPP
#define CANTOR_BASIS_HPP

#include <libff/algebra/fields/binary/gf256.hpp>
#include <libff/algebra/fields/binary/gf192.hpp>
#include <libff/algebra/fields/binary/gf128.hpp>


#include <cstdint>

namespace cantor {
constexpr uint64_t cantor_in_gf2to128[32][2] = {
{ 1ULL, 0ULL }, 
{ 7451958335100816136ULL, 2979905974001933049ULL }, 
{ 18379359142562139939ULL, 11678753174964950217ULL }, 
{ 3806377295275615041ULL, 5765478048843264955ULL }, 
{ 5964716134623269487ULL, 9493367565905753810ULL }, 
{ 9694806746384895118ULL, 13535957400069408490ULL }, 
{ 14351831746480308002ULL, 15456817264020168565ULL }, 
{ 9871113426680930296ULL, 8445484340771454142ULL }, 
{ 14359679680787500726ULL, 7550534080838848438ULL }, 
{ 16739092789252320136ULL, 2353990313433176932ULL }, 
{ 14719285806930375842ULL, 12012312824096232185ULL }, 
{ 1974138172944805506ULL, 5825489713145847074ULL }, 
{ 15445503469418106218ULL, 90969054999167022ULL }, 
{ 8059850556265388212ULL, 2953653984965001800ULL }, 
{ 7268505461910041633ULL, 4953499268284119582ULL }, 
{ 13038602132939861025ULL, 7300897941315533517ULL }, 
{ 7708217696466479543ULL, 14100031012539072218ULL }, 
{ 1597091802311147163ULL, 13433988028959701392ULL }, 
{ 5779922654005177096ULL, 6061763682392805431ULL }, 
{ 16646986035395884342ULL, 7237388961652792994ULL }, 
{ 7509783092144364182ULL, 13992239891422946119ULL }, 
{ 9793984009891398548ULL, 4094349670899195314ULL }, 
{ 13880442574164208726ULL, 17280450716671644785ULL }, 
{ 11848651046983888041ULL, 3525163445638352364ULL }, 
{ 7101246094675088360ULL, 7604684647264185373ULL }, 
{ 18062125951643640557ULL, 4943948116682625526ULL }, 
{ 15985826151980389386ULL, 5510116886042966723ULL }, 
{ 10705059525085712865ULL, 7046178871788993114ULL }, 
{ 3887632620019156611ULL, 10365684951231465744ULL }, 
{ 1562360105926376799ULL, 4355509103307351537ULL }, 
{ 408253524801996846ULL, 2335938568451506623ULL }, 
{ 15248215514618293389ULL, 12080761354232803155ULL }, 
};

constexpr uint64_t cantor_in_gf2to192[32][3] = {
{ 1ULL, 0ULL, 0ULL }, 
{ 16014634050487485283ULL, 16978235315239073606ULL, 9386955127219893094ULL }, 
{ 13424893308507606834ULL, 11233532708402460447ULL, 4082512380071599798ULL }, 
{ 10669169197622269317ULL, 7071067124090717472ULL, 17154146349007620980ULL }, 
{ 9653561949929338298ULL, 18307677646607657700ULL, 11162273653448437575ULL }, 
{ 2683298653331894528ULL, 9807969963509817198ULL, 17525065780465316215ULL }, 
{ 10197833708189968947ULL, 2162421271793820381ULL, 8708999575096158917ULL }, 
{ 17695871925345486192ULL, 6924844500364224979ULL, 14374459029697578160ULL }, 
{ 2378926416455028231ULL, 14428274843850787645ULL, 4074820414482187345ULL }, 
{ 15138957932092253425ULL, 13994166550576108086ULL, 583295383967148621ULL }, 
{ 13072573684139935757ULL, 7377840615088061606ULL, 6937057331406913763ULL }, 
{ 7176286181541940258ULL, 14596475903298116028ULL, 966137765370736813ULL }, 
{ 4064605431590058055ULL, 17937910313596056824ULL, 307463326398094751ULL }, 
{ 15701115620667936712ULL, 8623573554857555394ULL, 5512636005401755556ULL }, 
{ 14308827438577740935ULL, 464168070451445910ULL, 7010578308837245376ULL }, 
{ 2872043414702942962ULL, 4588670326847941999ULL, 7572856683175321431ULL }, 
{ 15508308333359791367ULL, 12402981616573343305ULL, 10010093091425375152ULL }, 
{ 2260944134095245335ULL, 8879646382644305467ULL, 13828918654434469590ULL }, 
{ 4292428149716505395ULL, 13715338507344371688ULL, 18304369431853710060ULL }, 
{ 6798873809084604803ULL, 7332456723060056004ULL, 12947440788817867629ULL }, 
{ 6362113142539702614ULL, 13009304916043978961ULL, 8678760891565411325ULL }, 
{ 14025649688704269500ULL, 11783187763670457301ULL, 17226018381836104573ULL }, 
{ 4768372253376589915ULL, 6492341141090757345ULL, 3580074320837950326ULL }, 
{ 11790323710401212925ULL, 6043320687163225905ULL, 867749219931376122ULL }, 
{ 18017950268879638928ULL, 7505976772114611827ULL, 7053329737176438450ULL }, 
{ 11894638759023433348ULL, 10729034237361130438ULL, 14079181323940245768ULL }, 
{ 9139457552236419885ULL, 14909866304646898351ULL, 6727694507904350048ULL }, 
{ 4752116567203473942ULL, 3161022692618161096ULL, 14601331375339449668ULL }, 
{ 2972206590846752589ULL, 17523928617342767557ULL, 17481634340549977693ULL }, 
{ 15260949995370935139ULL, 6133276243876484366ULL, 2129240687154481665ULL }, 
{ 17847778721442747030ULL, 7231504111038672525ULL, 16362445873133434154ULL }, 
{ 7417495702491592850ULL, 11861346107362429494ULL, 2104197242529906842ULL }, 
};

constexpr uint64_t cantor_in_gf2to256[32][4] = {
{ 1ULL, 0ULL, 0ULL, 0ULL }, 
{ 4295033141ULL, 1ULL, 1ULL, 0ULL }, 
{ 13615767094782902071ULL, 16509767166769775667ULL, 17355192366725112762ULL, 17376248881838693815ULL }, 
{ 4644524726043978731ULL, 15693424397002034251ULL, 15710347196241526592ULL, 10880548238252614091ULL }, 
{ 640118059613985261ULL, 1313903195796726235ULL, 3396766875825798676ULL, 14192144114219446720ULL }, 
{ 10077849366122156232ULL, 7086092472166378657ULL, 15100903294859545647ULL, 3987845167958163125ULL }, 
{ 16270511978075044806ULL, 16164563811376147135ULL, 2625578537547985342ULL, 6072447074683886330ULL }, 
{ 5630018274122687930ULL, 8996055410665817774ULL, 3069990775405148075ULL, 12687162812642014724ULL }, 
{ 5754938134996921238ULL, 8937587289433511601ULL, 156331452736549519ULL, 10952228242332826081ULL }, 
{ 14899878026048491996ULL, 11881287613761720319ULL, 3157557464693671546ULL, 8490414338663093587ULL }, 
{ 6144948151697131770ULL, 12829366715966933238ULL, 5161617361959799949ULL, 16577793721757437839ULL }, 
{ 17335731826601981145ULL, 10374971554879084408ULL, 6560426406833767547ULL, 15376035997087156491ULL }, 
{ 18156021140703472090ULL, 4583267173085506923ULL, 8143265948793651304ULL, 13846076204877184192ULL }, 
{ 12368643584047939295ULL, 11819919576370109150ULL, 17178066221154598626ULL, 3537106026951133662ULL }, 
{ 17860052627717163084ULL, 1023859705452441292ULL, 4445661619295054034ULL, 16613301729520929541ULL }, 
{ 12567644037189678575ULL, 10989995650777694894ULL, 16650321402958599001ULL, 15394086554448135710ULL }, 
{ 3895293214564875702ULL, 6229113196406670081ULL, 3409072240043564264ULL, 9340437959674295503ULL }, 
{ 6003731047390282906ULL, 9123062914094717993ULL, 1995146645112670937ULL, 9677318193463286565ULL }, 
{ 11863262441345585988ULL, 16424244390609524150ULL, 12179255713357253792ULL, 8443460857916446437ULL }, 
{ 952441961121987866ULL, 17558130836699076420ULL, 13849621668659962270ULL, 5858758139358259385ULL }, 
{ 4842952427975513570ULL, 5536087762530766659ULL, 9066314258170351741ULL, 12689759026623861971ULL }, 
{ 11934042102125943131ULL, 5684306568414579395ULL, 388029345282030729ULL, 10845248503285669883ULL }, 
{ 3177192301120302685ULL, 15102579401182205913ULL, 12475081644470835988ULL, 14078415256170588310ULL }, 
{ 17763443710946410651ULL, 14346436287575459071ULL, 14335403489212834782ULL, 14214157082939204186ULL }, 
{ 5080490340599271256ULL, 12689939537085429179ULL, 1467244048409411438ULL, 14393358436686695531ULL }, 
{ 2614694687946290618ULL, 386260273944309489ULL, 3493066445529797887ULL, 14058644840294299294ULL }, 
{ 14488596929048962438ULL, 13785333696019006426ULL, 18177809138659256097ULL, 9536437080691907638ULL }, 
{ 9522776976361151227ULL, 12648439438049231636ULL, 9389018560787912221ULL, 9245451799559131985ULL }, 
{ 17882361982162706348ULL, 568081022572744249ULL, 13390524583313730048ULL, 14385592888705335992ULL }, 
{ 4104017265333605612ULL, 15082008458465896366ULL, 16686233106678210090ULL, 3681558827891653969ULL }, 
{ 7929606058812646144ULL, 3003101923230410791ULL, 13498978919646001267ULL, 11922546952913825908ULL }, 
{ 18231145936351310928ULL, 11618316067220172972ULL, 7652517275783664224ULL, 2804331428984460444ULL }, 
};

extern const libff::gf128 cantor_combinations_8R_in_gf2to128[1024];

extern const libff::gf192 cantor_combinations_8R_in_gf2to192[1024];

extern const libff::gf256 cantor_combinations_8R_in_gf2to256[1024];

constexpr unsigned s_i[31][15] = {
    {},                                             //S_0
    {1},                                        //S_1
    {3},                                        //S_2
    {7, 6, 4},                          //S_3
    {15},                                       //S_4
    {31, 30, 16},                       //S_5
    {63, 60, 48},                       //S_6
    {127, 126, 124, 120, 112, 96, 64},                                          //S_7
    {255},                                                                                              //S_8
    {511, 510, 256},                                                                            //S_9
    {1023, 1020, 768},                                                                         //S_10
    {2047, 2046, 2044, 2040, 1792, 1536, 1024},                                //S_11
    {4095, 4080, 3840},                                                                        //S_12
    {8191, 8190, 8176, 8160, 7936, 7680, 4096},                                //S_13
    {16383, 16380, 16368, 16320, 16128, 15360, 12288},                         //S_14
    {32767, 32766, 32764, 32760, 32752, 32736, 32704, 32640, 32512, 32256, 31744, 30720, 28672, 24576, 16384},                                                                 //S_15
    {65535},                                                                                           //S_16
    {131071, 131070, 65536},                                                                   //S_17
    {262143, 262140, 196608},                                                                  //S_18
    {524287, 524286, 524284, 524280, 458752, 393216, 262144},                  //S_19
    {1048575, 1048560, 983040},                                                                //S_20
    {2097151, 2097150, 2097136, 2097120, 2031616, 1966080, 1048576},           //S_21
    {4194303, 4194300, 4194288, 4194240, 4128768, 3932160, 3145728},           //S_22
    {8388607, 8388606, 8388604, 8388600, 8388592, 8388576, 8388544, 8388480, 8323072, 8257536, 8126464, 7864320, 7340032, 6291456, 4194304},                                   //S_23
    {16777215, 16776960, 16711680},                                                            //S_24
};

constexpr unsigned int n_terms[31] =
    { 0, 1, 1, 3, 1, 3, 3, 7, 1, 3, 3, 7, 3, 7, 7, 15,
    1, 3, 3, 7, 3, 7, 7, 15, 3, 7, 7, 15, 7, 15, 15
};

} //namespace cantor 
#endif